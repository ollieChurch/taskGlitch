# Schedule Updates on Task Changes

**Phase:** 1 | **Version:** 0.13 | **Status:** Complete

## Problem

If a user edits a task that is currently in the active schedule (e.g., changes its size from Short to Long), the schedule does not update. This causes the schedule to be inaccurate — time allocations will be wrong.

## Requirements

### Core

- [x] When a task in the active schedule is edited, detect if any schedule-relevant properties changed (size, name, priority, category)
- [x] If task size changed: update the schedule's time calculations and shift subsequent task times
- [x] If task name changed: update the display name in the schedule
- [x] If task is deleted: remove it from the schedule and recalculate times
- [x] Show the user a notification when a schedule has been auto-updated

### Decision: Auto-update vs Prompt

- [x] **Decision: Auto-update with notification banner.** Schedule is automatically updated when a task is edited, and a dismissible notification tells the user what happened.
- [x] Notification auto-dismisses after 5 seconds

### Edge Cases

- [x] Task size increased but no longer fits in the remaining schedule time — **Decision: let schedule run over with a warning.** An overflow warning is shown below the Estimated Finish Time when the schedule exceeds the planned end time.
- [x] Task's category is removed from schedule filter — **Decision: prompt user with choice.** A modal asks "Keep in Schedule?" / "Remove from Schedule?" when the task's updated category no longer matches the schedule's category filter.
- [x] Completing a task from the backlog view also removes it from the schedule

## Implementation Notes

- Added 4 schedule sync functions to `useTaskActions.js`: `findTaskInSchedule`, `syncTaskToSchedule`, `applyScheduleUpdate`, `removeTaskFromSchedule`
- Added notification state (`notification`, `pendingScheduleUpdate`) and actions to Pinia store
- Enhanced `NotificationBanner.vue` with dismissible prop and dismiss emit
- TaskModal `handleOk()` now calls `handleScheduleSync()` after saving — auto-updates or triggers category prompt
- TaskModal `deleteTask()` now removes from schedule first
- TaskCard `handleMainAction()` removes from schedule when completing
- TaskSchedule `scheduleDetails` computed now detects overflow by comparing estimated finish to scheduled finish
- App.vue includes global notification banner with auto-dismiss watcher and category prompt modal

## Files Affected

- `src/composables/useTaskActions.js` — schedule sync functions
- `src/stores/app.js` — notification state, pendingScheduleUpdate state, actions
- `src/components/TaskModal.vue` — schedule sync on save/delete
- `src/components/TaskCard.vue` — schedule removal on complete
- `src/components/TaskSchedule.vue` — overflow detection and warning
- `src/components/NotificationBanner.vue` — dismiss button
- `src/App.vue` — notification banner, category prompt modal, auto-dismiss watcher

## Acceptance Criteria

1. ✅ Editing a task that's in the active schedule updates the schedule accordingly
2. ✅ Deleting a scheduled task removes it from the schedule and recalculates
3. ✅ User is informed when their schedule has been automatically updated
4. ✅ Schedule time calculations remain accurate after task changes
5. ✅ Overflow warning shown when tasks run past scheduled end time
6. ✅ Category mismatch prompts user with keep/remove choice
